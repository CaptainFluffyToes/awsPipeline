---
- hosts: all 
  tasks:
    - name: Start standby container
      docker_container:
        name: "{{ conjur_standby_name }}"
        image: "{{ conjur_image_name }}"
        state: started
        restart_policy: unless-stopped
        security_opts:
          - seccomp:unconfined
        pull: yes
        exposed_ports:
          - '443'
          - '444'
          - '1999'
          - '5432'
        published_ports:
          - "443:443"
          - "444:444"
          - "1999:1999"
          - "5432:5432"
        log_driver: journald
        volumes:
          - "/opt/cyberark/dap/configuration:/opt/cyberark/dap/configuration:rw"
          - "/opt/cyberark/dap/security:/opt/cyberark/dap/security:rw"
          - "/opt/cyberark/dap/backups:/opt/conjur/backup:rw"
          - "/opt/cyberark/dap/seeds:/opt/cyberark/dap/seeds:rw"
          - "/opt/cyberark/dap/logs:/var/log/conjur:rw"

  vars:
    - conjur_image_name: 'captainfluffytoes/dap:latest'
    - conjur_standby_name: 'conjurstandby'
    - conjur_admin_password: 'Cyberark123!'
    - conjur_company: 'cyberark'
    - ansible_python_interpreter: /usr/bin/python3